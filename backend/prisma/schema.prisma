datasource db {
  provider = "postgresql" 
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  ADMIN
  USER
}

enum History_Type {
  GET
  USE
}


model User {
  User_ID      Int       @id @default(autoincrement())
  Full_name    String
  User_name    String    @unique
  User_password String
  Email String
  Role Role? @default(USER)
  Points Int @default(0)
  
  waste   Waste[]
  pointHistory  PointHistory[]
  recycleShop  RecycleShop[]
  wasteVote  WasteVote[]
}

model Waste {
  Waste_ID   Int      @id @default(autoincrement())
  User_ID    Int
  WasteType_ID   Int
  Image_path String
  Timestamp  DateTime @default(now())
  Probs   Float[]
  Is_correct Boolean @default(false)
  Vote_wastetype Int[] @default([0, 0, 0, 0]) //[อินทรีย์, อันตราย, ทั่วไป, รีไซเคิล]

  user   User   @relation(fields: [User_ID], references: [User_ID])
  wasteType  WasteType  @relation(fields: [WasteType_ID], references: [WasteType_ID])
  wasteVote  WasteVote[]
}

model WasteType {
  WasteType_ID   Int     @id @default(autoincrement())
  Waste_name String

  waste Waste[]
}


model PointHistory {
  PointHistory_ID Int      @id @default(autoincrement())
  User_ID    Int
  History_Detail   String
  History_Type  History_Type

  user  User  @relation(fields: [User_ID], references: [User_ID])
}

model RecycleShop {
   Shop_ID   Int     @id @default(autoincrement())
   User_ID    Int
   Shop_name String
   Tel_num String
   Location Float[] //[Lat, Long]
   Accepted_cate Int[]
   Status Boolean @default(false)

   user  User  @relation(fields: [User_ID], references: [User_ID])
}

model WasteVote{
  Vote_ID Int @id @default(autoincrement())
  Waste_ID   Int 
  User_ID    Int
  Vote_Detail String
  Timestamp  DateTime @default(now())

  user  User  @relation(fields: [User_ID], references: [User_ID])
  waste  Waste  @relation(fields: [Waste_ID], references: [Waste_ID])
}

model PointShop {
  Item_ID Int @id @default(autoincrement())
  Item_name String
  Usage_Limit Int
  Point_Usage Int
  Expire_Date DateTime
}

//npx prisma migrate dev --name init